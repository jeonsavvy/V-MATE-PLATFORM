# Netlify 설정 파일
# Netlify Functions와 빌드 설정

[build]
  # React 프로젝트 빌드 명령
  command = "npm run build"
  # 퍼블리시 디렉토리 (Vite 빌드 결과물)
  publish = "dist"

[build.environment]
  # Node.js 버전 (Netlify Functions 사용 시 필요, Ubuntu 20.04+ 호환)
  NODE_VERSION = "20"
  # Supabase 공개 클라이언트 키/URL은 번들 포함이 정상이라 secrets scan 예외 처리
  SECRETS_SCAN_OMIT_KEYS = "VITE_SUPABASE_URL,VITE_SUPABASE_ANON_KEY"

# Functions 설정
[functions]
  # Functions 디렉토리
  directory = "netlify/functions"
  # ESM 함수(export const handler) 호환성 고정
  node_bundler = "esbuild"

# 리다이렉트 규칙 (SPA 지원)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[[headers]]
  for = "/index.html"
  [headers.values]
    Cache-Control = "no-store, must-revalidate"

[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
